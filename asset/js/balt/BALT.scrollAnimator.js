var ScrollAnimator=function(){function o(){if(requestAnimFrame(o),Math.ceil(D)!==Math.floor(scrollTop)){D+=E.tweenSpeed*(scrollTop-D),$("#status").html(scrollTop)
for(var r in animation){var i=animation[r]
D>=i.startAt&&i.endAt>=D?(e(i),t(i)):n(i)}}}function t(o){var t=(o.startAt-D)/(o.startAt-o.endAt)
o.onProgress&&"function"==typeof o.onProgress&&o.onProgress(t)}function e(o){o._started||(o.onStartAnimate&&"function"==typeof o.onStartAnimate?o.onStartAnimate.call(o):o._elem.css("display","block"),o._started=!0)}function n(o){(o._started&&D>o.endAt||o._started&&o.startAt>D)&&(o.onEndAnimate&&"function"==typeof o.onEndAnimate?o.onEndAnimate.call(o):o._elem.css("display","none"),o._started=!1)}function r(){for(var o in animation){var t=animation[o]
void 0==t._elem&&(t._elem=$("#"+t.id))}}function i(){E.onResize&&"function"==typeof E.onResize&&E.onResize(),E.container,z={wWidth:E.container.width(),wHeight:E.container.height(),wCenter:{left:E.container.width()/2,top:E.container.height()/2}},a(),r(),h()}function a(){for(var o in animation){var t=animation[o]
t._started&&(delete t._elem,delete t._started)}}function c(){i()}function l(o){k.x=o.touches[0].pageX,k.y=o.touches[0].pageY,P=scrollTop}function s(){}function u(o){o.preventDefault(),offset={},offset.x=k.x-o.touches[0].pageX,offset.y=k.y-o.touches[0].pageY,scrollTop=Math.max(0,P+offset.y),f()}function d(o,t){scrollTop-=t*E.scrollSpeed,0>scrollTop&&(scrollTop=0),f()}function f(){0>scrollTop?scrollTop=0:scrollTop>E.maxScroll&&(scrollTop=E.maxScroll)}function m(){return"ontouchstart"in window}function p(o){var t={maxScroll:1e3,tickSpeed:30,scrollSpeed:20,useRAF:!0,tweenSpeed:.3,freezeTouchScroll:!1}
if(E=$.extend(t,o),animation=E.animation,M=m()){var e=E.container[0]
e.addEventListener("touchstart",l,!0),e.addEventListener("touchmove",u,!0),e.addEventListener("touchend",s,!0)}return q.on("mousewheel",d),I.on("resize",c),window.requestAnimFrame=function(){return console.log("REQUEST ANIME FRAME"),E.useRAF?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(o){window.setTimeout(o,E.tickSpeed)}:function(o){window.setTimeout(o,E.tickSpeed)}}(),i(),this}function h(){!F&&E.startAt&&(D=scrollTop=E.startAt),scrollTop++,F||(o(),F=!0),E.onStart&&"function"==typeof E.onStart&&E.onStart()}function g(){return z}function w(){return D}function T(){return E.maxScroll}function S(o){scrollTop=o}function A(){setInterval(v,100)}function v(){scrollTop+=5,scrollTop>E.maxScroll&&(scrollTop=D=0)}function b(){D=scrollTop}function _(){E.freezeTouchScroll=!0}function x(){E.freezeTouchScroll=!1}function y(){0==E.debugId||void 0==E.debugId?(console.log("debug on"),E.debugId=!0,$("#status2").show(),$("#status").show()):(console.log("debug off"),E.debugId=!1,$("#status2").hide(),$("#status").hide())
for(var o in animation){var t=animation[o]
1==E.debugId?(t._elem.css("border","1px dashed red"),t._elem.prepend('<div class="debugid">'+t.id+"</div>")):(t._elem.css("border",""),$("body").find(".debugid").remove())}}function R(){return E.debug}var z,E={},F=!1,I=$(window),q=$(document),M=!1,k={x:0,y:0},P=0,D=scrollTop=0
return{init:p,start:h,getPageInfo:g,getScrollTop:w,getMaxScroll:T,autoScroll:A,stopScroll:b,scrollTo:S,freezeTouchScroll:_,unfreezeTouchScroll:x,isDebug:R,toggleDebug:y}}
